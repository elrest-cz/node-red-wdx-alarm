<script type="text/javascript">

	function startNode(node, customMsg) {
		$.ajax({
			url: "inject/" + node.id,
			type: "POST",
			data: JSON.stringify(customMsg || {}),
			contentType: "application/json; charset=utf-8",
			success: function (resp) {
				RED.notify(node._("inject.success", { label: label }), { type: "success", id: "inject", timeout: 2000 });
			},
			error: function (jqXHR, textStatus, errorThrown) {
				if (jqXHR.status == 404) {
					RED.notify(node._("common.notification.error", { message: node._("common.notification.errors.not-deployed") }), "error");
				} else if (jqXHR.status == 500) {
					RED.notify(node._("common.notification.error", { message: node._("inject.errors.failed") }), "error");
				} else if (jqXHR.status == 0) {
					RED.notify(node._("common.notification.error", { message: node._("common.notification.errors.no-response") }), "error");
				} else {
					RED.notify(node._("common.notification.error", { message: node._("common.notification.errors.unexpected", { status: jqXHR.status, message: textStatus }) }), "error");
				}
			}
		});
	}

	RED.nodes.registerType('wago.wdx.alarm.list', {
		category: 'WDX Alarm',
		color: '#FFFFFF',
		defaults: {
			name: { value: "" },
			client: {
				type: "wago.wdx.web-socket",
				required: true
			},
		},
		inputs: 1,
		outputs: 2,
		outputLabels: ["Succeded", "Errored",],
		icon: "WagoLogo.svg",
		paletteLabel: "List",
		label: "WDX - Alarm - List",
		button: {
			onclick: function () {
				startNode(this);
			},
		},
	});

	RED.nodes.registerType('wago.wdx.alarm.list-active', {
		category: 'WDX Alarm',
		color: '#FFFFFF',
		defaults: {
			name: { value: "" },
			client: {
				type: "wago.wdx.web-socket",
				required: true
			},
		},
		inputs: 1,
		outputs: 2,
		outputLabels: ["Succeded", "Errored",],
		icon: "WagoLogo.svg",
		paletteLabel: "List Active",
		label: "WDX - Alarm - List Active",
		button: {
			onclick: function () {
				startNode(this);
			},
		},
	});

	RED.nodes.registerType('wago.wdx.alarm.list-history', {
		category: 'WDX Alarm',
		color: '#FFFFFF',
		defaults: {
			name: { value: "" },
			client: {
				type: "wago.wdx.web-socket",
				required: true
			},
			alarmUuid: {},
		},
		inputs: 1,
		outputs: 2,
		outputLabels: ["Succeded", "Errored",],
		icon: "WagoLogo.svg",
		paletteLabel: "List History",
		label: "WDX - Alarm - List History",
		button: {
			onclick: function () {
				startNode(this);
			},
		},
	});

	RED.nodes.registerType('wago.wdx.alarm.confirm', {
		category: 'WDX Alarm',
		color: '#FFFFFF',
		defaults: {
			name: { value: "" },
			client: {
				type: "wago.wdx.web-socket",
				required: true
			},
		},
		inputs: 1,
		outputs: 2,
		outputLabels: ["Succeded", "Errored",],
		icon: "WagoLogo.svg",
		paletteLabel: "Confirm",
		label: "WDX - Alarm - Confirm",
		button: {
			onclick: function () {
				startNode(this);
			},
		},
	});

	RED.nodes.registerType('wago.wdx.alarm.confirm-all', {
		category: 'WDX Alarm',
		color: '#FFFFFF',
		defaults: {
			name: { value: "" },
			client: {
				type: "wago.wdx.web-socket",
				required: true
			},
		},
		inputs: 1,
		outputs: 2,
		outputLabels: ["Succeded", "Errored",],
		icon: "WagoLogo.svg",
		paletteLabel: "Confirm All",
		label: "WDX - Alarm - Confirm All",
		button: {
			onclick: function () {
				startNode(this);
			},
		},
	});

	RED.nodes.registerType('wago.wdx.alarm.monitor', {
		category: 'WDX Alarm',
		color: '#FFFFFF',
		defaults: {
			name: { value: "" },
			client: {
				type: "wago.wdx.web-socket",
				required: true
			},
			subscribe: {
				type: "boolean",
			},
		},
		inputs: 1,
		outputs: 3,
		outputLabels: ["Succeded", "Errored", "Completed",],
		icon: "WagoLogo.svg",
		paletteLabel: "Monitor",
		label: "WDX - Alarm - Monitor",
		button: {
			onclick: function () {
				startNode(this);
			},
		},
	});

	RED.nodes.registerType('wago.wdx.alarm.detail', {
		category: 'WDX Alarm',
		color: '#FFFFFF',
		defaults: {
			name: { value: "" },
			client: {
				type: "wago.wdx.web-socket",
				required: true
			},
			alarmId: {
				value: '',
			}
		},
		inputs: 1,
		outputs: 2,
		outputLabels: ["Succeded", "Errored",],
		icon: "WagoLogo.svg",
		paletteLabel: "Detail",
		label: "WDX - Alarm - Detail",
		button: {
			onclick: function () {
				startNode(this);
			},
		},
	});

	RED.nodes.registerType('wago.wdx.alarm.delete', {
		category: 'WDX Alarm',
		color: '#FFFFFF',
		defaults: {
			name: { value: "" },
			client: {
				type: "wago.wdx.web-socket",
				required: true
			},
			alarmId: {
				value: '',
			}
		},
		inputs: 1,
		outputs: 2,
		outputLabels: ["Succeded", "Errored",],
		icon: "WagoLogo.svg",
		paletteLabel: "Delete",
		label: "WDX - Alarm - Delete",
		button: {
			onclick: function () {
				startNode(this);
			},
		},
	});

	RED.nodes.registerType('wago.wdx.alarm.save', {
		category: 'WDX Alarm',
		color: '#FFFFFF',
		defaults: {
			name: { value: "" },
			client: {
				type: "wago.wdx.web-socket",
				required: true
			},
			alarm: {
			}
		},
		inputs: 1,
		outputs: 2,
		outputLabels: ["Succeded", "Errored",],
		icon: "WagoLogo.svg",
		paletteLabel: "Save",
		label: "WDX - Alarm - Save",
		button: {
			onclick: function () {
				startNode(this);
			},
		},
	});

</script>

<script type="text/html" data-template-name="wago.wdx.alarm.list">

	<div class="form-row">

		<label for="node-input-client">
			<i class="fa fa-bookmark"></i>
			<span>Web Socket Client</span>
		</label>
		
		<input type="text" id="node-input-client">
	</div>

</script>

<script type="text/html" data-help-name="wago.wdx.alarm.list">
	<h2>WAGO - WDX - Alarm - List</h2>
	<p>Retrieves alarm list from WDX</p>
	<h2>Parameters</h2>
</script>

<script type="text/html" data-template-name="wago.wdx.alarm.list-active">

	<div class="form-row">

		<label for="node-input-client">
			<i class="fa fa-bookmark"></i>
			<span>Web Socket Client</span>
		</label>
		
		<input type="text" id="node-input-client">
	</div>

</script>

<script type="text/html" data-help-name="wago.wdx.alarm.list-active">
	<h2>WAGO - WDX - Alarm - List Active</h2>
	<p>Retrieves list of active alarm from WDX</p>
	<h2>Parameters</h2>
</script>

<script type="text/html" data-template-name="wago.wdx.alarm.list-history">

	<div class="form-row">

		<label for="node-input-client">
			<i class="fa fa-bookmark"></i>
			<span>Web Socket Client</span>
		</label>
		
		<input type="text" id="node-input-client">
	</div>


	<div class="form-row">
		<label for="node-input-alarm-uuid">Alarm UUID</label>
		<input type="text" id="node-input-alarm-uuid" placeholder="Alarm UUID">
	</div>

</script>

<script type="text/html" data-help-name="wago.wdx.alarm.list-history">
	<h2>WAGO - WDX - Alarm - List History</h2>
	<p>Retrieves list of alarm history from WDX</p>
	<h2>Parameters</h2>
</script>

<script type="text/html" data-template-name="wago.wdx.alarm.confirm">

	<div class="form-row">

		<label for="node-input-client">
			<i class="fa fa-bookmark"></i>
			<span>Web Socket Client</span>
		</label>
		
		<input type="text" id="node-input-client">

	</div>


	<div class="form-row">
		<label for="node-input-alarm-uuid">Alarm UUID</label>
		<input type="text" id="node-input-alarm-uuid" placeholder="Alarm UUID">
	</div>

</script>

<script type="text/html" data-help-name="wago.wdx.alarm.confirm">
	<h2>WAGO - WDX - Alarm - Confirm</h2>
	<p>Confirm alarm aknowledge in WDX</p>
	<h2>Parameters</h2>
</script>

<script type="text/html" data-template-name="wago.wdx.alarm.confirm-all">

	<div class="form-row">

		<label for="node-input-client">
			<i class="fa fa-bookmark"></i>
			<span>Web Socket Client</span>
		</label>
		
		<input type="text" id="node-input-client">

	</div>

</script>

<script type="text/html" data-help-name="wago.wdx.alarm.confirm-all">
	<h2>WAGO - WDX - Alarm - Confirm</h2>
	<p>Confirm alarm aknowledge in WDX</p>
	<h2>Parameters</h2>
</script>

<script type="text/html" data-template-name="wago.wdx.alarm.monitor">

	<div class="form-row">

		<label for="node-input-client">
			<i class="fa fa-bookmark"></i>
			<span>Web Socket Client</span>
		</label>
		
		<input type="text" id="node-input-client">

	</div>
	
	<div class="form-row">
		<label for="node-input-subscribe"><i class="fa fa-tag"></i>Subscribe</label>
		<input type="checkbox" id="node-input-subscribe" placeholder="">
	</div>

</script>

<script type="text/html" data-help-name="wago.wdx.alarm.monitor">
	<h2>WAGO - WDX - Alarm - Monitor</h2>
	<p>ubscribe/Unsubscribe to WDX Alarm monitor</p>
	<h2>Parameters</h2>
</script>

<script type="text/html" data-template-name="wago.wdx.alarm.detail">

	<div class="form-row">

		<label for="node-input-client">
			<i class="fa fa-bookmark"></i>
			<span>Web Socket Client</span>
		</label>
		
		<input type="text" id="node-input-client">

	</div>


	<div class="form-row">
		<label for="node-input-alarm-uuid">Alarm UUID</label>
		<input type="text" id="node-input-alarm-uuid" placeholder="Alarm UUID">
	</div>

</script>

<script type="text/html" data-help-name="wago.wdx.alarm.detail">
	<h2>WAGO - WDX - Alarm - Monitor</h2>
	<p>Subscribe/Unsubscribe to WDX Alarm monitor</p>
	<h2>Parameters</h2>
</script>

<script type="text/html" data-template-name="wago.wdx.alarm.delete">

	<div class="form-row">

		<label for="node-input-client">
			<i class="fa fa-bookmark"></i>
			<span>Web Socket Client</span>
		</label>
		
		<input type="text" id="node-input-client">

	</div>


	<div class="form-row">
		<label for="node-input-alarm-uuid">Alarm UUID</label>
		<input type="text" id="node-input-alarm-uuid" placeholder="Alarm UUID">
	</div>

</script>

<script type="text/html" data-help-name="wago.wdx.alarm.delete">
	<h2>WAGO - WDX - Alarm - Delete</h2>
	<p>Deletes alarm in WDX</p>
	<h2>Parameters</h2>
</script>

<script type="text/html" data-template-name="wago.wdx.alarm.save">

	<div class="form-row">

		<label for="node-input-client">
			<i class="fa fa-bookmark"></i>
			<span>Web Socket Client</span>
		</label>
		
		<input type="text" id="node-input-client">

	</div>


	<div class="form-row">
		<label for="node-input-alarm">Alarm</label>
		<input type="text" id="node-input-alarm" placeholder="Alarm JSON Model">
	</div>

</script>

<script type="text/html" data-help-name="wago.wdx.alarm.save">
	<h2>WAGO - WDX - Alarm - Save</h2>
	<p>Save alarm to WDX</p>
	<h2>Parameters</h2>
</script>